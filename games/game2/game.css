/* Wrapper that centers the layout and provides spacing around the game */
.game2-wrapper {
    max-width: 1080px;
    margin: 0 auto;
    padding: clamp(0.75rem, 2vw, 2.5rem) clamp(0.5rem, 1.5vw, 1.5rem) clamp(1rem, 2vw, 3.5rem);
    display: flex;
    flex-direction: column;
    height: 100vh; /* Fallback for browsers that don't support dvh */
    height: 100dvh; /* Use dynamic viewport height (excludes browser UI on mobile) - overrides vh if supported */
    max-height: 100vh; /* Fallback for browsers that don't support dvh */
    max-height: 100dvh; /* Prevent exceeding viewport - overrides vh if supported */
    box-sizing: border-box; /* Include padding in height calculation */
    overflow: hidden; /* Prevent any overflow - background must stay within viewport */
}

/* Header container with buttons row and title below */
.game2-header {
    display: flex;
    flex-direction: column;
    gap: clamp(0.5rem, 2vw, 1.5rem);
    margin-bottom: clamp(0.25rem, 1vw, 1rem);
    flex-shrink: 0; /* Prevent header from being compressed - it needs its natural height */
}

/* Top row with back button and start button horizontally aligned */
.game2-header__buttons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
}

/* Central block for title and instructions */
.game2-header__center {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
}

/* Back button uses soft colors and large touch target */
.back-button {
    background: #38bdf8;
    color: #0f172a;
    font-weight: 700;
    padding: 0.6rem 1rem; /* Slightly smaller */
    border-radius: 9999px;
    text-decoration: none;
    font-size: 1.75rem; /* Slightly smaller arrow */
    box-shadow: rgba(0, 0, 0, 0.25) 0 14px 28px, rgba(0, 0, 0, 0.22) 0 10px 10px;
    transition: transform 150ms ease, box-shadow 150ms ease;
}

.back-button:active {
    transform: translateY(2px);
    box-shadow: rgba(0, 0, 0, 0.25) 0 10px 18px, rgba(0, 0, 0, 0.2) 0 6px 6px;
}

/* Game title */
.game2-title {
    font-size: clamp(1.8rem, 4vw, 3.4rem);
    font-weight: 800;
    color: #1e1b4b;
}

/* Instruction text below the title */
.game2-instructions {
    font-size: clamp(1rem, 2vw, 1.6rem);
    font-weight: 600;
    color: #312e81;
}


/* Game board with background image and grid layout */
.animal-field {
    position: relative;
    width: 100%;
    flex: 1; /* Fill remaining space in flex container */
    min-height: 0; /* Allow flex to shrink below content size - critical for fitting viewport */
    max-height: none; /* Allow flex to determine height based on available space */
    padding: clamp(1rem, 3vw, 3rem);
    border-radius: 2rem;
    background:
        linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.0)),
        url('images/background.png');
    background-size: cover;
    background-position: center;
    box-shadow: inset 0 0 25px rgba(30, 64, 175, 0.12);
    position: relative;
    overflow: hidden;
}

/* Variant that locks the game board during pause */
.animal-field--paused {
    pointer-events: none;
    filter: grayscale(0.25) brightness(0.9);
}

/* Card that displays animal image and handles clicks */
.animal-card {
    position: absolute;
    width: clamp(95px, 22vw, 200px);
    height: clamp(95px, 22vw, 200px);
    max-width: 100%;
    max-height: 100%;
    border-radius: 1.5rem;
    background: transparent;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: rgba(0, 0, 0, 0.25) 0 8px 16px, rgba(0, 0, 0, 0.15) 0 4px 8px;
    cursor: pointer;
    transition: transform 200ms ease, box-shadow 200ms ease;
    overflow: hidden;
    animation: floaty 7s ease-in-out infinite;
    animation-delay: calc(var(--float-phase, 0) * 1s);
    padding: 0;
    margin: 0;
}

/* Small lift effect on hover/focus */
.animal-card:hover,
.animal-card:focus-visible {
    transform: translateY(-6px) scale(1.05) !important;
    box-shadow: rgba(0, 0, 0, 0.3) 0 12px 24px, rgba(0, 0, 0, 0.2) 0 6px 12px;
    animation-play-state: paused;
}

/* Selected state must override hover/focus */
.animal-card--selected:hover,
.animal-card--selected:focus-visible {
    transform: none !important;
    animation-play-state: running !important;
}

/* The animal image itself */
.animal-card__image {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    pointer-events: none;
    display: block;
    border-radius: 1.5rem;
}

/* When a card is selected, pause all other cards' animations */
.animal-field:has(.animal-card--selected) .animal-card:not(.animal-card--selected):not(.animal-card--found),
.animal-field--has-selected .animal-card:not(.animal-card--selected):not(.animal-card--found) {
    animation-play-state: paused !important;
}

/* Selected state - when an animal card is currently playing its sound */
/* Must come after the pause rule to ensure it overrides */
.animal-card--selected,
.animal-field:has(.animal-card--selected) .animal-card--selected,
.animal-field--has-selected .animal-card--selected {
    border: 4px solid #fbbf24;
    box-shadow: 
        rgba(251, 191, 36, 0.5) 0 0 24px,
        rgba(251, 191, 36, 0.35) 0 10px 26px,
        rgba(0, 0, 0, 0.25) 0 4px 8px;
    /* Disable transition so animation can work properly */
    transition: none !important;
    /* Force hardware acceleration and composite layer for smooth animation */
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden; /* Safari support */
    /* Ensure hover/focus states don't interfere */
    pointer-events: auto;
    /* Force GPU layer on mobile - use perspective to trigger composite layer */
    transform-style: preserve-3d;
    -webkit-transform-style: preserve-3d;
    /* Override the base floaty animation completely with the selected-move animation */
    animation: selected-move 1.5s ease-in-out infinite, selected-pulse 1.2s ease-in-out infinite !important;
    animation-play-state: running !important;
    animation-delay: 0s !important;
    z-index: 10;
}

/* Enhanced movement animation for selected card - more pronounced movement */
/* Using translate3d to force GPU acceleration on mobile */
@keyframes selected-move {
    0%, 100% {
        transform: scale(1.18) translate3d(0, -10px, 0) rotate(0deg);
    }
    20% {
        transform: scale(1.18) translate3d(18px, -22px, 0) rotate(5deg);
    }
    40% {
        transform: scale(1.18) translate3d(-15px, -12px, 0) rotate(-5deg);
    }
    60% {
        transform: scale(1.18) translate3d(12px, -26px, 0) rotate(4deg);
    }
    80% {
        transform: scale(1.18) translate3d(-10px, -16px, 0) rotate(-4deg);
    }
}

/* Pulsing animation for selected card */
@keyframes selected-pulse {
    0%, 100% {
        box-shadow: 
            rgba(251, 191, 36, 0.5) 0 0 24px,
            rgba(251, 191, 36, 0.35) 0 10px 26px,
            rgba(0, 0, 0, 0.25) 0 4px 8px;
    }
    50% {
        box-shadow: 
            rgba(251, 191, 36, 0.7) 0 0 28px,
            rgba(251, 191, 36, 0.5) 0 10px 30px,
            rgba(0, 0, 0, 0.25) 0 4px 8px;
    }
}

/* Animation when the animal has been clicked */
.animal-card--found {
    animation: animal-pop-out 320ms ease forwards !important;
    animation-play-state: running !important;
    /* Stop the floaty animation */
    animation-name: animal-pop-out !important;
}

/* Keyframes to make the card disappear smoothly */
@keyframes animal-pop-out {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    30% {
        transform: scale(1.08);
    }
    100% {
        transform: scale(0.4);
        opacity: 0;
    }
}

/* Floating animation for animal cards */
@keyframes floaty {
    0% { transform: translate(0, 0) scale(1) rotate(0deg); }
    20% { transform: translate(3px, -6px) scale(1.02) rotate(-0.8deg); }
    40% { transform: translate(-4px, 2px) scale(0.99) rotate(0.9deg); }
    60% { transform: translate(5px, -3px) scale(1.01) rotate(-0.5deg); }
    80% { transform: translate(-3px, 4px) scale(1.02) rotate(0.6deg); }
    100% { transform: translate(0, 0) scale(1) rotate(0deg); }
}

/* Overlay completion dialog */
.completion-dialog {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(8px);
    z-index: 1000;
}

/* Keep dialog hidden via hidden attribute */
.completion-dialog[hidden] {
    display: none !important;
}

/* The dialog content itself */
.completion-dialog__content {
    background: #ffffff;
    border-radius: 1.75rem;
    padding: clamp(2rem, 5vw, 2.5rem);
    text-align: center;
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.28);
    max-width: 90%;
    width: min(560px, 100%);
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

/* Title in the dialog */
.completion-dialog__title {
    font-size: clamp(2rem, 4vw, 2.6rem);
    font-weight: 800;
    color: #1e1b4b;
}

/* Video in the completion dialog */
.completion-dialog__video {
    width: 100%;
    max-width: 100%;
    height: auto;
    border-radius: 1rem;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    background: #000000;
}

/* Message text in the dialog */
.completion-dialog__message {
    font-size: clamp(1.2rem, 2.5vw, 1.5rem);
    color: #312e81;
}

/* Button row in the dialog */
.completion-dialog__actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
}

/* Base style for dialog buttons */
.completion-dialog__btn {
    padding: 0.75rem 1.9rem;
    border-radius: 9999px;
    border: none;
    font-size: 1.2rem;
    font-weight: 700;
    cursor: pointer;
    transition: transform 150ms ease, box-shadow 150ms ease;
    box-shadow: rgba(0, 0, 0, 0.25) 0 14px 28px, rgba(0, 0, 0, 0.22) 0 10px 10px;
    color: #ffffff;
}

/* Primary button (play again) */
.completion-dialog__btn--primary {
    background: linear-gradient(135deg, #34d399, #10b981);
}

/* Secondary button (back) */
.completion-dialog__btn--secondary {
    background: linear-gradient(135deg, #60a5fa, #3b82f6);
}

/* Press effect on dialog buttons */
.completion-dialog__btn:active {
    transform: translateY(2px);
    box-shadow: rgba(0, 0, 0, 0.25) 0 10px 20px, rgba(0, 0, 0, 0.2) 0 6px 6px;
}

/* Responsive adjustments for smaller screens */
@media (max-width: 480px) {
    .back-button {
        font-size: 1.2rem; /* Slightly smaller arrow on small screens */
        padding: 0.5rem 0.85rem; /* Slightly smaller padding */
    }
}

@media (max-width: 640px) {
    .game2-header {
        gap: 1rem;
    }

    .game2-header__buttons {
        gap: 0.75rem;
    }

    .back-button {
        padding: 0.5rem 0.85rem; /* Slightly smaller padding */
        font-size: 1.5rem; /* Slightly smaller arrow on medium screens */
    }

}

